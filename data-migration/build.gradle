
plugins {
    id 'application'

}

application {
    mainClassName = 'com.quorum.tessera.data.migration.Main'
    applicationDefaultJvmArgs = ['-Dtessera.cli.type=DATA_MIGRATION']
}

dependencies {
    implementation 'info.picocli:picocli'
    implementation project(':shared')
    implementation project(':config')
    implementation project(':ddls')
    implementation project(':cli:cli-api')
    implementation 'commons-codec:commons-codec:1.6'
    implementation 'commons-io:commons-io:2.6'
    implementation 'org.bouncycastle:bcpkix-jdk15on'
    runtimeOnly 'org.xerial:sqlite-jdbc:3.23.1'
    runtimeOnly 'com.h2database:h2:1.4.200'
    testImplementation 'com.mockrunner:mockrunner-jdbc:2.0.1'
    testImplementation 'org.xerial:sqlite-jdbc:3.23.1'
    testImplementation 'com.h2database:h2:1.4.200'
}

task unzipDdl(type:Copy) {
    def zipFile = file(project(':ddls').jar.outputs.files.getFiles()[0])
    def outputDir = file("${buildDir}/resources/test/ddls")
    from zipTree(zipFile)
    into outputDir
}


processResources.dependsOn unzipDdl


