CREATE TABLE ST_TRANSACTION (CIPHER_TEXT LONGVARBINARY NOT NULL, CIPHER_TEXT_NONCE LONGVARBINARY NOT NULL, EXEC_HASH LONGVARBINARY, DATA_ISSUES VARCHAR(255), PRIVACY_MODE SMALLINT, RECIPIENT_NONCE LONGVARBINARY NOT NULL, SENDER_KEY LONGVARBINARY NOT NULL, TIMESTAMP BIGINT, VALIDATION_STAGE BIGINT, HASH VARCHAR(255) NOT NULL, PRIMARY KEY (HASH));
CREATE INDEX ST_TRANSACTION_VALSTG ON ST_TRANSACTION (VALIDATION_STAGE);
CREATE TABLE ST_AFFECTED_TRANSACTION (SECURITY_HASH LONGVARBINARY, AFFECTED_HASH VARCHAR(255) NOT NULL, SOURCE_HASH VARCHAR(255) NOT NULL, PRIMARY KEY (AFFECTED_HASH, SOURCE_HASH));
CREATE TABLE ST_TRANSACTION_RECIPIENT (BOX LONGVARBINARY, INITIATOR BOOLEAN, HASH VARCHAR(255) NOT NULL, RECIPIENT VARCHAR(255) NOT NULL, PRIMARY KEY (HASH, RECIPIENT));
CREATE TABLE ST_TRANSACTION_VERSION (NANOTIME BIGINT, PAYLOAD LONGVARBINARY NOT NULL, PRIVACY_MODE SMALLINT, TIMESTAMP BIGINT, HASH VARCHAR(255) NOT NULL, RECIPIENT VARCHAR(255) NOT NULL, PRIMARY KEY (HASH, RECIPIENT));
ALTER TABLE ST_AFFECTED_TRANSACTION ADD CONSTRAINT FK_ST_AFFECTED_TRANSACTION_SOURCE_HASH FOREIGN KEY (SOURCE_HASH) REFERENCES ST_TRANSACTION (HASH);
ALTER TABLE ST_TRANSACTION_RECIPIENT ADD CONSTRAINT FK_ST_TRANSACTION_RECIPIENT_HASH FOREIGN KEY (HASH) REFERENCES ST_TRANSACTION (HASH);
ALTER TABLE ST_TRANSACTION_VERSION ADD CONSTRAINT FK_ST_TRANSACTION_VERSION_HASH FOREIGN KEY (HASH) REFERENCES ST_TRANSACTION (HASH);